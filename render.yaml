services:
  - type: web
    name: rag-api
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port ${PORT:-8000}
    envVars:
      - key: GROQ_API_KEY
        sync: false
      - key: LLM_MODEL
        value: llama3-8b-8192
      - key: EMBEDDING_MODEL
        value: all-MiniLM-L6-v2
      - key: VECTOR_DB_PATH
        value: /tmp/vectorstore
      - key: COLLECTION_NAME
        value: rag_collection

  - type: web
    name: rag-frontend
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: streamlit run app.py --server.port ${PORT:-8501} --server.address 0.0.0.0 --server.headless true
    envVars:
      - key: API_BASE_URL
        sync: false